<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  <meta name="theme-color" content="#3b6dc6" />
Â  <title>Smart Inventory</title>
Â  <link rel="stylesheet" href="style.css" />
Â  <link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#3b6dc6" />
<link rel="apple-touch-icon" href="inventory192.png" />

</head>
<script>window.IS_ADMIN_VIEW = true;</script>
<body>

Â  Â  Â  Â 
Â  Â  <main class="page">
Â  Â  Â  Â  Â <header class="admin-header">
Â  Â  Â  Â  Â  Â  <h1>Admin Studio</h1>
Â  Â  Â  Â  Â  Â  <button onclick="window.location.href='index.html'" class="btn-black">
Â  Â  Â  Â  Â  Â  Â  Â  ğŸ  Home (Public View)
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </header>

Â  Â  Â  Â  <button id="toggleFormBtn" class="btn-toggle">Toggle Input Form (Show)</button>

Â  Â  Â  Â  <section id="productsContainer" class="products-area">
Â  Â  Â  Â  Â  Â  <div class="hint">OTHER PRODUCT CONTAINERS WILL APPEAR HERE</div>
Â  Â  Â  Â  </section>

Â  Â  Â  Â  <div id="inputContainer" style="display: none;">
Â  Â  Â  Â  Â  Â  <section class="product-panel add-panel">
Â  Â  Â  Â  Â  Â  Â  Â  
                <div class="form-row">
                    <div class="label-black">BUSINESS NAME</div>
                    <input id="businessName" class="text-input" type="text" placeholder="e.g., Jane's Boutique" />
                </div>
                
                <div class="form-row">
                    <div class="label-black">CATEGORY</div>
                    <input id="businessCategory" class="text-input" type="text" placeholder="e.g., Clothing, Electronics, Food" />
                </div>
                <div class="form-row">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="label-black">PRODUCT name</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input id="productName" class="text-input" type="text" placeholder="Product name appears here" />
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â <div class="form-row">
Â  Â  <div class="label-black">Quantity</div>
Â  Â  <input id="productQuantity" class="text-input" 
Â  Â  Â  Â  type="text" 
Â  Â  Â  Â  placeholder="Number of products" 
Â  Â  Â  Â  min="0"
Â  Â  Â  Â  data-numeric="true"
Â  Â  />
</div>

Â  Â  Â  Â  Â  Â  Â  Â <div class="form-row">
Â  Â  <div class="label-black">BUYING PRICE</div>
Â  Â  <input id="productBuy" class="text-input" 
Â  Â  Â  Â  Â  Â type="text" 
Â  Â  Â  Â  Â  Â placeholder="Buying price appears here" 
Â  Â  Â  Â  Â  Â data-numeric="true"
Â  Â  />
</div>

<div class="form-row">
Â  Â  <div class="label-black">SELLING PRICE</div>
Â  Â  <input id="productSell" class="text-input" 
Â  Â  Â  Â  Â  Â type="text" 
Â  Â  Â  Â  Â  Â placeholder="Selling price appears here" 
Â  Â  Â  Â  Â  Â data-numeric="true"
Â  Â  />
</div>

<label for="productDescription">Description:</label>
<textarea id="productDescription" placeholder="A short, catchy description of the product..."></textarea>

<label for="productDetails">Details / Specs:</label>
<textarea id="productDetails" placeholder="Detailed specifications, ingredients, or features..."></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="thumb-and-link">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="newThumb" class="thumb-preview small">Thumbnail appears</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="link-column">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input id="driveLink" class="text-input" type="text" placeholder="Paste your google Drive Link" />
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="previewBtn" class="btn-black small">Preview</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="saveLinkBtn" class="btn-black small">Save Link</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="add-row">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="openGalleryBtn" class="btn-black big">Open Link Gallery</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="addProductBtn" class="btn-black big">Add product</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </section>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <dialog id="linkGalleryDialog">
Â  Â  Â  Â  Â  Â  <div class="gallery-header">
Â  Â  Â  Â  Â  Â  Â  Â  <h2>Link Gallery</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <button id="closeGalleryBtn" class="btn-black small">Close</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <section id="galleryContainer" class="products-area"></section>
Â  Â  Â  Â  </dialog>

Â  Â  <dialog id="updateDialog" class="modal">
Â  Â  <div class="modal-body">
Â  Â  Â  Â  <button id="closeUpdateDialogBtn" class="close-btn">X</button> 
Â  Â  Â  Â  <p class="product-title">Product: <strong id="updateProductName"></strong></p>
Â  Â  Â  Â  
Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="sellQuantity">ğŸ“‰ Units Sold (Decrease Stock):</label>
Â  Â  Â  Â  Â  Â  <input 
Â  Â  Â  Â  Â  Â  Â  Â  type="text" 
Â  Â  Â  Â  Â  Â  Â  Â  id="sellQuantity" 
Â  Â  Â  Â  Â  Â  Â  Â  min="0" 
Â  Â  Â  Â  Â  Â  Â  Â  value="0" 
Â  Â  Â  Â  Â  Â  Â  Â  placeholder="Enter quantity sold"
Â  Â  Â  Â  Â  Â  Â  Â  class="input-field"
Â  Â  Â  Â  Â  Â  Â  Â  data-numeric="true" >
Â  Â  Â  Â  </div>
Â  Â  Â  Â  
Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="restockQuantity">ğŸ“¦ Units Restocked (Increase Stock):</label>
Â  Â  Â  Â  Â  Â  <input 
Â  Â  Â  Â  Â  Â  Â  Â  type="text" 
Â  Â  Â  Â  Â  Â  Â  Â  id="restockQuantity" 
Â  Â  Â  Â  Â  Â  Â  Â  min="0" 
Â  Â  Â  Â  Â  Â  Â  Â  value="0" 
Â  Â  Â  Â  Â  Â  Â  Â  placeholder="Enter quantity restocked"
Â  Â  Â  Â  Â  Â  Â  Â  class="input-field"
Â  Â  Â  Â  Â  Â  Â  Â  data-numeric="true" >
Â  Â  Â  Â  </div>
Â  Â  Â  Â  
Â  Â  Â  Â  <button id="executeUpdateButton" class="btn btn-primary">
Â  Â  Â  Â  Â  Â  Execute Stock Update
Â  Â  Â  Â  </button>
Â  Â  Â  Â  
Â  Â  </div>
</dialog>
Â  Â  Â  Â  <script>
Â  Â  Â  Â  Â  Â  // âœ… Register the Service Worker
Â  Â  Â  Â  Â  Â  if ("serviceWorker" in navigator) {
Â  Â  Â  Â  Â  Â  Â  Â  navigator.serviceWorker
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .register("service-worker.js")
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .then(() => console.log("âœ… Service Worker registered successfully."))
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .catch((err) => console.error("âŒ Service Worker registration failed:", err));
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // âœ… Handle PWA Install Prompt
Â  Â  Â  Â  Â  Â  let deferredPrompt;
Â  Â  Â  Â  Â  Â  const installBtn = document.createElement("button");
Â  Â  Â  Â  Â  Â  installBtn.textContent = "ğŸ“² Install App";
Â  Â  Â  Â  Â  Â  installBtn.style.cssText = `
Â  Â  Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  Â  Â  bottom: 20px;
Â  Â  Â  Â  Â  Â  Â  Â  right: 20px;
Â  Â  Â  Â  Â  Â  Â  Â  background: #3b6dc6;
Â  Â  Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  Â  Â  padding: 12px 20px;
Â  Â  Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
Â  Â  Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  Â  Â  z-index: 9999;
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  document.body.appendChild(installBtn);

Â  Â  Â  Â  Â  Â  window.addEventListener("beforeinstallprompt", (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  // Prevent the mini-infobar from appearing
Â  Â  Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  Â  Â  deferredPrompt = e;

Â  Â  Â  Â  Â  Â  Â  Â  // Show the install button
Â  Â  Â  Â  Â  Â  Â  Â  installBtn.style.display = "block";
Â  Â  Â  Â  Â  Â  Â  Â  console.log("ğŸ“¦ PWA install prompt ready.");

Â  Â  Â  Â  Â  Â  Â  Â  installBtn.addEventListener("click", async () => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  installBtn.style.display = "none";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deferredPrompt.prompt(); // Show the native prompt

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  outcome
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } = await deferredPrompt.userChoice;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log(`User response to install: ${outcome}`);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deferredPrompt = null;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  // Optional: Notify if app is already installed
Â  Â  Â  Â  Â  Â  window.addEventListener("appinstalled", () => {
Â  Â  Â  Â  Â  Â  Â  Â  console.log("âœ… App installed successfully!");
Â  Â  Â  Â  Â  Â  Â  Â  installBtn.remove();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  </script>

Â  Â  Â  Â 

Â  Â  Â  Â  <script>

Â  Â  Â  Â  Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  // Select all inputs you want to format
Â  Â  const numericInputs = document.querySelectorAll('input[data-numeric="true"]');

Â  Â  // Function to strip commas and return a pure number string
Â  Â  const unformatNumber = (value) => {
Â  Â  Â  Â  // Replace all commas with an empty string
Â  Â  Â  Â  return value.replace(/,/g, '');
Â  Â  };

Â  Â  // Function to format the number with thousands separators (commas)
Â  Â  const formatNumber = (value) => {
Â  Â  Â  Â  // First, unformat to ensure only pure numeric value remains
Â  Â  Â  Â  const rawValue = unformatNumber(value); 
Â  Â  Â  Â  
Â  Â  Â  Â  // Ensure the value is treated as a string for regex
Â  Â  Â  Â  let [integerPart, decimalPart] = rawValue.split('.');
Â  Â  Â  Â  
Â  Â  Â  Â  // Add commas to the integer part
Â  Â  Â  Â  integerPart = integerPart.replace(/\B(?=(\d{3})+(?!\d))/g, ",");

Â  Â  Â  Â  // Recombine integer and decimal parts
Â  Â  Â  Â  if (decimalPart !== undefined) {
Â  Â  Â  Â  Â  Â  return `${integerPart}.${decimalPart}`;
Â  Â  Â  Â  }
Â  Â  Â  Â  return integerPart;
Â  Â  };

Â  Â  numericInputs.forEach(input => {
Â  Â  Â  Â  // 1. Format on input (while user is typing)
Â  Â  Â  Â  input.addEventListener('input', (event) => {
Â  Â  Â  Â  Â  Â  const cursorStart = event.target.selectionStart;
Â  Â  Â  Â  Â  Â  const originalLength = event.target.value.length;

Â  Â  Â  Â  Â  Â  const unformatted = unformatNumber(event.target.value);
Â  Â  Â  Â  Â  Â  const formatted = formatNumber(unformatted);
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  event.target.value = formatted;

Â  Â  Â  Â  Â  Â  // Maintain cursor position after formatting
Â  Â  Â  Â  Â  Â  const newLength = event.target.value.length;
Â  Â  Â  Â  Â  Â  const newCursor = cursorStart + (newLength - originalLength);
Â  Â  Â  Â  Â  Â  event.target.setSelectionRange(newCursor, newCursor);
Â  Â  Â  Â  });

Â  Â  Â  Â  // 2. Format on blur (when user clicks away)
Â  Â  Â  Â  input.addEventListener('blur', (event) => {
Â  Â  Â  Â  Â  Â  event.target.value = formatNumber(event.target.value);
Â  Â  Â  Â  });
Â  Â  Â  Â  
Â  Â  Â  Â  // 3. Optional: Unformat before form submission (if required)
Â  Â  Â  Â  // If you are submitting the form, you must unformat the value 
Â  Â  Â  Â  // back to a standard number (no commas) before sending it to the server.
Â  Â  });
});
Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  Â  const toggleBtn = document.getElementById('toggleFormBtn');
Â  Â  Â  Â  const inputContainer = document.getElementById('inputContainer');
Â  Â  Â  Â  const content = inputContainer.querySelector('.product-panel.add-panel');
Â  Â  Â  Â  
Â  Â  Â  Â  // 1. Set initial state for smooth toggle (Hidden by default)
Â  Â  Â  Â  // inputContainer must be styled with overflow: hidden; and max-height: 0;
Â  Â  Â  Â  inputContainer.style.maxHeight = '0';
Â  Â  Â  Â  inputContainer.style.opacity = '0';
Â  Â  Â  Â  // Ensure it's not display: none, or transition won't work
Â  Â  Â  Â  inputContainer.style.display = 'block'; 

Â  Â  Â  Â  // Set initial button text to 'Show'
Â  Â  Â  Â  toggleBtn.textContent = 'Toggle Input Form (Show)';

Â  Â  Â  Â  toggleBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  // Check if the container is visually hidden (max-height is 0)
Â  Â  Â  Â  Â  Â  const isHidden = inputContainer.style.maxHeight === '0px';

Â  Â  Â  Â  Â  Â  if (isHidden) {
Â  Â  Â  Â  Â  Â  Â  Â  // SHOW: Temporarily set max-height to its content height (plus a buffer)
Â  Â  Â  Â  Â  Â  Â  Â  // This forces the transition from 0 to the actual height.
Â  Â  Â  Â  Â  Â  Â  Â  const scrollHeight = content.scrollHeight; 
Â  Â  Â  Â  Â  Â  Â  Â  inputContainer.style.maxHeight = scrollHeight + 40 + 'px'; // + buffer for padding/margin
Â  Â  Â  Â  Â  Â  Â  Â  inputContainer.style.opacity = '1';
Â  Â  Â  Â  Â  Â  Â  Â  toggleBtn.textContent = 'Toggle Input Form (Hide)';

Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // HIDE: First set max-height to its current scrollHeight, 
Â  Â  Â  Â  Â  Â  Â  Â  // then set it to 0 after a tiny delay. This ensures the transition works.
Â  Â  Â  Â  Â  Â  Â  Â  // We also set the max-height to 0 directly, as it's the target.
Â  Â  Â  Â  Â  Â  Â  Â  inputContainer.style.maxHeight = '0';
Â  Â  Â  Â  Â  Â  Â  Â  inputContainer.style.opacity = '0';
Â  Â  Â  Â  Â  Â  Â  Â  toggleBtn.textContent = 'Toggle Input Form (Show)';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  });
</script>



Â  Â  Â  Â  <script src="script.js" defer></script>

Â  Â  </main>
</body>
</html>